import{d as P,r as v,c as x,_ as E,a as F,b as g,o as m,w as k,e as n,n as b,t as h,f as _,g as V,h as T,i as S,j as G,k as w,l as A,F as L,m as $,u as q,p as M,s as C}from"./index-feV8QH7Y.js";import{G as D,a as I}from"./GlobalLoader-DnKxe2ww.js";import{S as z}from"./SectionBlock-B_SyPFlN.js";const N=e=>{window.__AULAS_META=e;const r={};e.forEach(a=>{const s=a.unidade||"Aulas";r[s]||(r[s]=[]),r[s].push(a)});const l=[];return Object.keys(r).sort((a,s)=>a.localeCompare(s,"pt")).forEach(a=>{r[a].forEach(s=>{const d=(s.arquivo||"").replace(/\.html$/i,"");l.push({id:d,title:s.titulo,description:s.descricao,status:s.ativo?"available":"soon",unidade:a,ativo:s.ativo})})}),l},O=e=>(window.__LISTAS_META=e,e.map(r=>({id:(r.arquivo||"").replace(/\.json$/i,""),title:r.titulo,description:r.descricao,progress:0,progressText:"Carregando progresso..."}))),R=P("data",()=>{const e=v(!0),r=v(null),l=v([]),a=v([]),s=v([]),d=v([]),f=x(()=>{const t={};return s.value.forEach(i=>{const o=i.unidade||"Aulas";t[o]||(t[o]=[]),t[o].push(i)}),t});return{loading:e,error:r,aulas:l,listas:a,filteredAulas:s,filteredListas:d,groupedFilteredAulas:f,applyFilters:t=>{t==="all"?(s.value=[...l.value],d.value=[...a.value]):t==="aulas"?(s.value=[...l.value],d.value=[]):t==="listas"&&(s.value=[],d.value=[...a.value])},loadData:async()=>{if(l.value.length>0&&a.value.length>0){e.value=!1;return}try{e.value=!0,r.value=null;const[t,i]=await Promise.all([fetch("aulas/aulas.json"),fetch("listas/listas.json")]);if(!t.ok)throw new Error("Falha ao carregar aulas.");if(!i.ok)throw new Error("Falha ao carregar listas.");const o=await t.json(),u=await i.json();l.value=N(o),a.value=O(u),s.value=[...l.value],d.value=[...a.value]}catch(t){console.error("Failed to load data store:",t),r.value=t.message}finally{e.value=!1}}}}),H=F({name:"AulaCard",props:{aula:{type:Object,required:!0}},setup(){return{}}}),J={class:"flex flex-col items-start gap-2"},U={class:"leading-none"};function K(e,r,l,a,s,d){const f=_("router-link");return m(),g(f,{to:`/aula/${e.aula.id}`,class:b(["relative z-0 block card cursor-pointer",e.aula.ativo?"card--interactive":"card--disabled cursor-not-allowed pointer-events-none"]),"aria-disabled":e.aula.ativo?"false":"true",tabindex:e.aula.ativo?0:-1,"aria-label":e.aula.title+(e.aula.ativo?"":" indisponível")},{default:k(()=>[n("div",J,[n("span",{class:b(["badge self-end",e.aula.status==="available"?"badge--success":"badge--warning"])},[n("i",{class:b(["flex-shrink-0",e.aula.status==="available"?"fa-solid fa-circle":"fa-regular fa-clock"])},null,2),n("span",U,h(e.aula.status==="available"?"Disponível":"Em breve"),1)],2),n("h3",{class:b(["font-bold text-title-large mb-2",e.aula.ativo?"text-primary-800 dark:text-primary-200":"text-neutral-700 dark:text-neutral-300"])},h(e.aula.title),3)]),n("p",{class:b(["text-body-medium",e.aula.ativo?"text-neutral-700 dark:text-neutral-300":"text-disabled"])},h(e.aula.description),3)]),_:1},8,["to","class","aria-disabled","tabindex","aria-label"])}const Q=E(H,[["render",K]]),W=F({name:"ListaCard",props:{lista:{type:Object,required:!0}},setup(e){const r=v(0),l=v("Progresso não iniciado"),a=(c,p)=>{try{const t=JSON.parse(c);return Array.isArray(t)?t:p}catch{return p}},s=c=>{if(typeof window>"u"||!window.localStorage)return 0;try{const p=localStorage.getItem(`lista_${c}_total`);if(!p)return 0;const t=parseInt(p,10);return Number.isFinite(t)&&t>0?t:0}catch{return 0}},d=()=>{if(!e.lista?.id||typeof window>"u"||!window.localStorage){r.value=0,l.value="Progresso não iniciado";return}const c=`lista_${e.lista.id}`,t=a(localStorage.getItem(`${c}_completed`)||"[]",[]).length,i=s(e.lista.id);if(i>0){const o=Math.min(t/i,1);r.value=Math.round(o*100),l.value=`${t} de ${i} exercícios concluídos`}else t>0?(r.value=0,l.value=`${t} exercícios concluídos`):(r.value=0,l.value="Progresso não iniciado")},f=c=>{if(!c?.key||!e.lista?.id)return;const p=`lista_${e.lista.id}`;(c.key===`${p}_completed`||c.key===`${p}_total`)&&d()};return V(()=>{d(),typeof window<"u"&&window.addEventListener("storage",f)}),T(()=>{typeof window<"u"&&window.removeEventListener("storage",f)}),S(()=>e.lista?.id,()=>d(),{immediate:!0}),{progress:r,progressText:l}}}),X={class:"flex flex-col items-start gap-2"},Y={class:"font-bold text-title-large text-primary-800 dark:text-primary-200 mb-2"},Z={class:"text-body-medium text-neutral-700 dark:text-neutral-300 mb-3"},ee={class:"text-label-small text-neutral-600 dark:text-neutral-400 mb-1"},ae=["aria-valuenow"];function te(e,r,l,a,s,d){const f=_("router-link");return m(),g(f,{to:`/lista/${e.lista.id}`,class:"relative z-0 block card card--interactive cursor-pointer","data-list-id":e.lista.id,"aria-label":`Lista ${e.lista.title}`},{default:k(()=>[n("div",X,[r[0]||(r[0]=n("div",{class:"badge self-end badge--secondary"},[n("i",{class:"flex-shrink-0 fa-solid fa-list"}),n("span",{class:"leading-none"},"Exercícios")],-1)),n("h3",Y,h(e.lista.title),1)]),n("p",Z,h(e.lista.description),1),n("div",ee,h(e.progressText),1),n("div",{class:"progress",role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[n("div",{class:"progress__bar progress__bar--secondary",style:G({width:e.progress+"%"})},null,4)],8,ae)]),_:1},8,["to","data-list-id","aria-label"])}const se=E(W,[["render",te]]),re={name:"HomeView",components:{AulaCard:Q,ListaCard:se,SectionBlock:z,GlobalAlert:I,GlobalLoader:D},setup(){const{branding:e}=q(),r=M(),{currentFilter:l,currentViewMode:a}=C(r),s=R(),{loading:d}=C(s),f=()=>{document.querySelectorAll(".group-grid").forEach((u,y)=>{Array.from(u.children).forEach((B,j)=>B.style.setProperty("--d",`${y*120+j*40}ms`))});const o=document.getElementById("listas-container");o&&Array.from(o.children).forEach((u,y)=>u.style.setProperty("--d",`${y*40}ms`))},c=()=>{document.querySelectorAll(".group-grid, #listas-container").forEach(o=>{o.classList.add("layout-fade"),a.value==="list"?(o.classList.remove("grid-cards"),o.classList.add("grid","grid-cols-1","gap-6")):(o.classList.remove("grid","grid-cols-1","gap-6"),o.classList.add("grid-cards")),setTimeout(()=>o.classList.remove("layout-fade"),200)}),f()};V(()=>{s.loadData(),c(),f()}),S(a,()=>{c()}),S(l,()=>{const i=document.documentElement;l.value==="listas"&&i.classList.remove("legacy-md2"),document.querySelectorAll(".group-grid, #listas-container").forEach(u=>{u.classList.add("layout-fade"),setTimeout(()=>u.classList.remove("layout-fade"),200)}),f()});const p=x(()=>{if(l.value==="listas")return{};const i={};return s.aulas.forEach(o=>{const u=o.unidade||"Aulas";i[u]||(i[u]=[]),i[u].push(o)}),i}),t=x(()=>l.value==="aulas"?[]:s.listas);return{branding:e,loading:d,groupedAulasView:p,listasView:t,currentFilter:l}}},oe={id:"cards-container",class:"space-y-8"},le={class:"group-title section__subtitle"},ie={class:"group-grid relative z-0 grid-cards anim-cards"},ne={id:"listas-container",class:"grid-cards anim-cards"};function de(e,r,l,a,s,d){const f=_("GlobalLoader"),c=_("GlobalAlert"),p=_("AulaCard"),t=_("SectionBlock"),i=_("ListaCard");return m(),w("div",null,[a.currentFilter!=="listas"?(m(),g(t,{key:0,id:"home",title:"Aulas",animate:!0,divider:!0},{default:k(()=>[n("div",oe,[a.loading?(m(),g(f,{key:0,title:"Carregando aulas...",subtitle:"Preparando o material de estudo."})):Object.keys(a.groupedAulasView).length===0&&(a.currentFilter==="all"||a.currentFilter==="aulas")?(m(),g(c,{key:1,text:"Nenhuma aula encontrada.",variant:"info",class:"text-center"})):(m(!0),w(L,{key:2},$(a.groupedAulasView,(o,u)=>(m(),w("div",{key:u,class:"space-y-4"},[n("h3",le,h(u),1),n("div",ie,[(m(!0),w(L,null,$(o,y=>(m(),g(p,{key:y.id,aula:y},null,8,["aula"]))),128))])]))),128))])]),_:1})):A("",!0),a.currentFilter!=="aulas"?(m(),g(t,{key:1,id:"listas",title:"Lista de Exercícios",tight:!0,animate:!0,divider:!0},{default:k(()=>[n("div",ne,[a.loading?(m(),g(f,{key:0,title:"Carregando listas...",subtitle:"Buscando os desafios."})):a.listasView.length===0&&(a.currentFilter==="all"||a.currentFilter==="listas")?(m(),g(c,{key:1,text:"Nenhuma lista encontrada.",variant:"info",class:"col-span-full text-center"})):A("",!0),(m(!0),w(L,null,$(a.listasView,o=>(m(),g(i,{key:o.id,lista:o},null,8,["lista"]))),128))])]),_:1})):A("",!0)])}const me=E(re,[["render",de],["__scopeId","data-v-baf70073"]]);export{me as default};
